## Methods

### Cell lines and reagents

#### Establishment of the immortalized mouse lemur fibroblast cell line

Primary fibroblasts were established using methods outlined in Larsen and Harris et al [@doi:10.1186/s12915-017-0439-6].
For the current study, we used an immortalized version of these primary mouse lemur fibroblasts.
This cell line was generated by transfecting passage six primary cells at approximately 60% confluency with 5 µg of human hTERT (hTERT) plasmid DNA per well of a 6-well plate using Lipofectamine® 2000 diluted in Opti-MEM® medium.
Twenty-four hours post transfection, cells were placed under selection using G418 sulfate at a concentration of 300 µg/mL for two weeks.
Selected cells were then plated into a 96-well plate and remained under G418 sulfate maintenance at a concentration of 100 µg/mL to establish single cell colonies.
Approximately 2 weeks post transfection, colonies were observed in 19 of the 96 wells and these cells underwent subsequent propagation and expansion.

#### Normal human fibroblasts

Telomerase-immortalized normal human fibroblasts (NHF1) were previously described [@doi:10.1128/MCB.22.24.8552-8561.2002;@doi:10.1101/gad.261271.115].
All cells were grown in Dulbecco’s modified Eagle’s medium supplemented with 10% fetal bovine serum at 37°C in a 5% CO2 humidified chamber.

### Clonogenic Survival Assay

Cells were seeded in 10 cm plates at 300 cells/plate, grown for 16 hours, and then UV irradiated as follows.
After removing and reserving culture medium, cells were placed under a GE germicidal lamp that emits primarily 254-nm UV light (UV-C) at 1 J/m<sup>2</sup>sec connected to a digital timer to give the indicated dose.
Following irradiation, the culture medium was replaced, and the cells were incubated for 7 days.
Plates were then washed with phosphate-buffered saline (PBS), the cells were fixed for 10 min in 75% methanol/25% acetic acid, and stained with 0.5% crystal violet stain (J.T. Baker) in 25% methanol for 30 min.
The plates were then washed extensively in tap water to remove the excess stain.
After drying, images of the stained cells were taken on a Molecular Imager Chemi-Doc XRS+ system (Bio-Rad) for presentation of representative, qualitative results.
Colonies were counted and the surviving fraction was calculated by dividing the number of colonies on treated plates by the number on the untreated plates.
Each condition was performed in triplicate and the experiment was repeated three independent times.

### Immunoslot Blot Analysis
Repair of UV photoproducts from genomic DNA was measured as described previously [@doi:10.1158/0008-5472.CAN-10-0095].
Cells were UV irradiated as described above for a dose of 10J/m<sup>2</sup>.
Following irradiation, the culture medium was replaced, and the cells were incubated for the indicated periods of time.
Genomic DNA (250 ng), isolated with a QIAamp DNA Mini kit (Qiagen), was immobilized on a nitrocellulose membrane with a Bio-Dot SF Cell immunoslot blot apparatus (Bio-Rad) and heated for 90 min at 80 °C under vacuum.
Blots were blocked in 5% milk and probed with an anti-(6-4)PP antibody (Cosmo Bio 64M-2 cat#NM-DND-001) or anti-CPD antibody (Cosmo Bio TDM-2 cat#NM-DND-002) as indicated.
The secondary antibody was horseradish peroxidase-linked anti-mouse IgG from GE Healthcare (catalog no. NA931V) and the chemiluminescent signals were visualized with Clarity Western ECL Substrate (Bio-Rad) and using a Molecular Imager Chemi-Doc XRS+ system (Bio-Rad).
Following immunoblotting, the blots were re-blotted with anti-ssDNA antibody (Millipore MAB3034 clone 16-19) to ensure equal loading of DNA.
The experiment was repeated three times, and representative results are presented.

### Detection of Excised Oligonucleotide Products of Nucleotide Excision Repair
Nucleotide excision repair activity was visualized as previously described [@doi:10.1074/jbc.M113.482257].
Cells grown to ~80% confluency in 15-cm plates were harvested the indicated time after irradiation with 20 J/m<sup>2</sup> of UV.
The cells were pelleted by centrifugation, subjected to a modified Hirt procedure where cell pellets were resuspended in a 10× packed cell volume of lysis buffer (50 mM Tris-Cl, pH 8.0, 10 mM EDTA, 1.2% SDS and 100 μg/ml RNase A) and incubated for 15 min at room temperature.
Following addition of a one-fourth volume of 5 M NaCl, the mixtures were gently mixed and incubated on ice for >16 h.
After centrifugation at maximum speed (20,000 × g) for 1 h, the supernatants were gently transferred to new tubes and treated with 20 μg of proteinase K for 15 min at 55 °C, extracted with phenol/chloroform, and then precipitated with ethanol.
The pellet was washed with 500 μl of 70% ethanol and resuspended in 10 μl of buffer EB (10 mM Tris-Cl (pH8.5)).
The excised oligonucleotide products of nucleotide excision repair were purified from the remaining material with either anti-(6-4)PP or anti-CPD antibodies as follows: For each reaction, 5 μl of protein G Dynabeads (Invitrogen, catalog no. 10003D) slurry and 5 μl of anti-rabbit Dynabeads (Invitrogen, catalog no. 11203D) slurry were washed three times with 50 μl of wash buffer I (20 mM Tris-Cl (pH 8.0), 2 mM EDTA, 150 mM NaCl, 1% Triton X-100, and 0.1% SDS) and then incubated with 1 μl of rabbit anti-mouse IgG and 1 μl of anti-(6-4)PP or anti-CPD antibody in 20 μl of IP buffer (20 mM Tris-Cl (pH 8.0), 2 mM EDTA, 150 mM NaCl, 1% Triton X-100, and 0.5% sodium deoxycholate) for 3 h at 4 °C.
After incubation, beads were separated from the liquid with a magnet and then mixed with 100 μl of IP buffer and 10 μl of DNA.
The mixtures were rotated at 4 °C overnight.
The beads were then washed sequentially with 200 μl each of wash buffer I, wash buffer II (20 mM Tris-Cl (pH 8.0), 2 mM EDTA, 500 mM NaCl, 1% Triton X-100, and 0.1% SDS), wash buffer III (10 mM Tris-Cl (pH 8.0), 1 mM EDTA, 150 mM LiCl, 1% Nonidet P-40, and 1% sodium deoxycholate), wash buffer IV (100 mM Tris-Cl (pH 8.0), 1 mM EDTA, 500 mM LiCl, 1% Nonidet P-40, and 1% sodium deoxycholate) and finally twice with TE (10 mM Tris-Cl (pH 8.0) and 1 mM EDTA).
The oligonucleotides containing UV photoproducts were eluted by incubation with 100 μl of elution buffer (50 mM NaHCO3, 1% SDS, and 20 μg/ml glycogen) at 65 °C for 15 min.
The eluted DNA was then isolated by phenol/chloroform extraction and followed by ethanol precipitation.
The excised oligonucleotides were resuspended in 10 μl of water, and half of the DNA was 3′-end labeled for 1 h at 37 °C in a 10-μl reaction containing 6 units of terminal deoxynucleotidyl transferase (New England Biolabs), 0.25 mM CoCl2, and 1 μCi of [α-32P]-3′-deoxyadenosine 5′-triphosphate (cordycepin 5′-triphosphate, Perkin Elmer Life Sciences) in 1× terminal deoxynucleotidyl transferase buffer (New England Biolabs).
2.5 fmol of a 50-nucleotide oligomer was included in all reactions as an internal control, and oligonucleotides of known length were resolved on all gels as size markers.
Following phenol-chloroform extraction and ethanol precipitation, the DNA was separated on urea-containing polyacrylamide gels, detected with a phosphorimager and was quantified using ImageQuant software (version 5.2, GE Healthcare).
The experiment was repeated three times.

### XR-seq library preparation

Samples were processed for XR-seq as previously described [@doi:10.1038/s41596-018-0093-7].
Cells grown to ~80% confluency in 15-cm plates were harvested either 5 minutes or 1 h after irradiation with 20 J/m<sup>2</sup> of UV, depending on the damage, (6-4)PP or CPD respectively, to be analyzed.
Samples from four plates were pooled, lysed, and immunoprecipitated with anti-TFIIH antibodies p62 (Santa Cruz Biotechnology, sc292) and p89 (XPB, Santa Cruz Biotechnology, sc293), and then ligated to adapters and processed for sequencing.

### RNA-seq library preparation

Total RNA was isolated from one 10-cm plate of exponentially growing NHF1 or Lemur cells using Trizol (Invitrogen) and the RNeasy Mini Kit (Qiagen) following the manufacturer's instructions.
The library preparation and strand-specific paired-end sequencing (2 × 150 bp) on a HiSeq 4000 platform (Illumina) was performed by Novogene Co., Ltd.

### Human and lemur genome alignment

MUMmer version 3.23 [@doi:10.1186/gb-2004-5-2-r12] was used to align grey mouse lemur genome (Mmur_3.0) to human genome (hg19) with `nucmer` subprogram.
The alignments were filtered based on criteria taking length and identity into account.
Alignments were listed in “delta format” by default by Nucmer.
For every reference (human) - query (lemur) pair, we kept the alignments which form the longest mutually consistent set.
Filtering step was performed with `delta-filter` subprogram.
`show-coords` subprogram was used to display summary information such as position, percent identity and other features of each alignment, in Btab format with `-B` and `-rclo` arguements.

We used `generateBED.R` [@url:https://github.com/compGenomeLab/lemurRepair] to write homologous human-lemur regions in a bed file.
Due to low genome coverage in XR-seq data sets small regions introduce random repair values.
Since we were not interested in too short alignments, we filtered out alignments shorter than 400 bp while generating the bed file.
Additionally, alignments with at percent similarity lower than 80 were filtered out of the list.
Resulting was a BED file with each homologus region between two genomes.

This output file contained regions in either genome that align to multiple regions in the other genome. To remove such regions, we used, we used `bedtools intersect` [@doi:10.1093/bioinformatics/btq033] to intersect the file with itself.
The command line we used was: `bedtools intersect -wo -s -a humanOverlapsLemur_short_noFilter.bed -b humanOverlapsLemur_short_noFilter.bed > human_intersect.txt`.
We compared this intersected output file to the `bed` file generated previously using `findDupAln.R` [@url:https://github.com/compGenomeLab/lemurRepair] to exclude regions in both genomes that align to multiple regions in other genome.
This resulted in a `bed` file of one-to-one homologous regions without multiple alignments for one region.


### XR-seq analysis

We trimmed 3’ adapter sequences (TGGAATTCTCGGGTGCCAAGGAACTCCAGTNNNNNNACGATCTCGTATGCCGTCTTCTGCTTG) using Cutadapt [@doi:10.14806/ej.17.1.200].
Bowtie2 version 2.3.4.1 [@doi:10.1038/nmeth.1923] was used to align sequencing reads onto reference genomes with default parameters.
With a two-step conversion process, the `sam` format was first converted (with SAMtools [@doi:10.1093/bioinformatics/btp352]) to `bam` format, which was then converted to `bed` format with BEDTools [@doi:10.1093/bioinformatics/btq033].
The resulting `bed` files were sorted by coordinates and duplicate regions were removed.
Command line we used was:
`sort -u -k1,1 -k2,2n -k3,3n ${SAMPLE}_cutadapt.bed >${SAMPLE}_cutadapt_sorted.bed`

### RNA-seq analysis

Sequencing reads were aligned to reference genome using STAR Aligner 2.6.1a [@doi:10.1093/bioinformatics/bts635] with default parameters.
The aligned reads were converted to `bed` format with `bedtools bamtobed`.
The resulting `bed` files were sorted by coordinates and duplicate regions were removed.
Command line we used was:
`sort -u -k1,1 -k2,2n -k3,3n ${SAMPLE}.bed >${SAMPLE}_sorted.bed`

### XR-seq simulation

We evaluated the correlation of repair mechanisms with both simulated and real XR-seq datasets.
Simulated datasets were generated for the overlapping regions between grey mouse lemur genome and human genome using ART simulator [@doi:10.1093/bioinformatics/btr708].
We used `bedtools getfasta` program with the `bed` file containing homologus regions between two organisms to generate a reference `fasta` file for ART simulator to produce synthetic reads.
By default ART simulator produces a `fastq` file with flat nucleotide distribution.
For a better representation of XR-seq characteristics in simulated dataset, we obtain nucleotide distribution frequencies of both species XR-seq reads.
We applied a scoring function where each nucleotide in the simulated read was scored based on the frequency of that nucleotide to be in that position in real dataset and obtained a total score for each simulated read.
Accordingly, best scoring 10 million reads were selected for both species from the simulated dataset with using `filter_syn.go` [@url:https://github.com/compGenomeLab/lemurRepair]

### Downstream Analysis

To calculate nucleotide frequencies of excised oligomers we first converted aligned Xr-seq reads to `fasta` format using `bedtools getfasta`.
Then using `frequency.go`  [@url:https://github.com/compGenomeLab/lemurRepair] we calculated nucleotide frequency of predominant oligomer (26nt) for each primate and damage type.

Command line used to get excised oligomer lengths:
`awk '{print $3-$2}' ${SAMPLE}_cutadapt_sorted.bed | sort -k1,1n | uniq -c | sed 's/\s\s*/ /g' | awk '{print $2"\t"$1}'`

Statistical analyses of immunoslot blot repair assays and clonogenic survival assay have been performed with Welch Two Sample t-test by using `t-test.R` [@url:https://github.com/compGenomeLab/lemurRepair].

For both genomes all annotated protein-coding genes were retrieved and genes that are closer to each other with less than 20kb were filtered out.
We used 5277 and 3366 number of genes for human and mouse lemur, respectively.
10 kb upstream and downstream of TSS and TES were divided into 100 bp windows.
XR-seq reads falling onto each bin were normalized to RPKM with `tcr.py` [@url:https://github.com/compGenomeLab/lemurRepair]
Then XR-seq RPKM values were normalized by the RPKM values derived by the mapped reads onto random genomic sites which are prepared using `bedtools shuffle` for protein-coding genes that are not closer to each other with less than 20kb.
Statistical significance of TCR profiles was estimated using Mann-Whitney U-test [@doi:10.1214/aoms/1177730491].
Statistical analyses were performed using `mann-w.py` [@url:https://github.com/compGenomeLab/lemurRepair] with SciPy [@doi:10.1038/s41592-019-0686-2].

We used `regions_rpkm.go` [@url:https://github.com/compGenomeLab/lemurRepair] to calculate RPKM values of XR-seq, RNA-seq, and simulated XR-seq for each overlapping region.
Regions with no XR-seq or RNA-seq reads were filtered out.

Circos plot for comprehensive summarization of all findings has been generated with `circosPlot.R` [@url:https://github.com/compGenomeLab/lemurRepair] by using R package `circlize`.[@doi:10.1093/bioinformatics/btu393]

PCA plot has been generated from read counts with  `plotPCA.R` [@url:https://github.com/compGenomeLab/lemurRepair], while  applying variance stabilizing transformation as described in DESeq2 [@doi:10.1186/s13059-014-0550-8] vignette.

Plots were prepared using `plotly` and `ggplot2`[@doi:10.1080/15366367.2019.1565254]. 
The manuscript was written using Manubot [@doi:10.1371/journal.pcbi.1007128].

## Data Access

All raw and processed sequencing data generated in this study have been submitted to the NCBI Gene Expression Omnibus (GEO; https://www.ncbi.nlm.nih.gov/geo/) under accession number GSE145883.
